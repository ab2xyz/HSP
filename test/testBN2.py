import torch
import numpy as np
import matplotlib.pyplot as plt
from torch import  nn as nn



data=[10.791114,4.5,9.808065,0,0,0,0,9.808065,0,0,3.995536,7.35E-17,1.36E-05,-0.331754,0.99997276,-0.33170858,0.9999091,-0.3316268,2,0,0,0,0,2,0,0,0,0,2,2,0,0,2,2,2,6.82E-06,2.2401092,7.732884,2.2322135,3.0065722,2.0549006,1.957875,1.9492614,1.02E-05,0,0,0,0,4.472323,10.739456,10.739456,3.9071364,3.9071364,3.9071364,3.9071364,0.9999966,2,0.010978005,1.5133725,10.739456,0.023980763,4.47021,9.764894,0.053972285,0.014122106,0.014101542,0.000761832,9.764883,0.001446213,-0.019855414,-0.003132128,-0.013077818,0.024608677,1000045,4.494819,1,101,10.791114,4.499999,9.808065,0,0,0,0,9.808065,0,1010002,0.4840106,0,1,0,0,0,0.8226597,7.732884,2.2335527,7.6765604,1,34,6,0.055425726,0.000510999,1,0,1,0.002945441,4,7.732884,2.2335527,-11,2.2840025,2.2840025,0,0.9996672,9.23E-05,0.9996672,6.34E-07,6.48E-05,0.000175059,1.9492614,-1.2753273,-1.2753273,1.4741642,1.4741642,7.483173,1.0904758,0,0,8.819784,13,0.25482318,1.0607419,-1,0,-11,-0.009050096,-0.007935796,-0.054102957,-1,0,0.8254192,0,0,3.0065722,2.2366889,3.056765,2,22,0,0.001001606,0.000510999,1,0,0,0.003242043,4,3.0065722,2.2366889,11,-0.85188884,-0.85188884,0,0.9999595,5.44E-10,0.9999595,2.39E-07,1.77E-36,4.02E-05,1.957875,1.2893839,1.2893839,-1.4733511,-1.4733511,2.2817104,-1.0814354,0,0,7.1975927,25,0.7091625,2.0754433,0.9996553,0.007428112,11,-0.00049514,-0.000434178,-0.000754679,1.0655642,10.739456,4.4702415,0,4.47021,1,4.4696994,0.9639824,9.764894,0.01673244,88888,0.05778236,0.05778236,0.014080063,0.014056563,0.014056563,0.000813127,0.000813127,9.764883,0.009040264,0.001441907,1.000022,0,0,0]

x=np.array(data)

x=(x-x.min())/(x.max()-x.min())



x.resize(17,17)

print(x.shape)

plt.imshow(x)





x0=x

x=x[np.newaxis,np.newaxis,:]



print(x.shape)

X=torch.Tensor(x)

conv = nn.Conv2d(1, 1, 3,padding=1)
bn = nn.BatchNorm2d(1)

def XPlot(X):
    y=X.mean(dim=[0,1])
    return y.detach().numpy()


n=1

fig=plt.figure('fig')
for i in range(n):
    X=conv(X)
    plt.clf()
    plt.imshow(XPlot(X))
    plt.title(str(i)+'conv')
    plt.pause(1)

    print(X.shape)

    X=bn(X)
    plt.clf()
    plt.imshow(XPlot(X))
    plt.title(str(i)+'bn')
    plt.pause(1)

y0=XPlot(X)
fig2=plt.figure('ratio')
plt.imshow(y0/x0)





plt.show()
#
